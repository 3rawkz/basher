#!/usr/bin/env bash
# Summary: Installs a package from github
# Usage: basher install <user> <package>

username="$1"
package="$2"

if [ -z "$username" ]; then
  basher-help install
  exit 1
fi

if [ -z "$package" ]; then
  basher-help install
  exit 1
fi

basher-clone "$username" "$package"

if [ ! -e "$BASHER_PACKAGES_PATH/$package/package.sh" ]; then
  echo "package.sh not found"
  rm -rf "$BASHER_PACKAGES_PATH/$package"
  exit 1
fi

source "$BASHER_PACKAGES_PATH/$package/package.sh" # TODO: make this secure?

IFS=: read -a bins <<< "$BIN"

for bin in "${bins[@]}"
do
  ln -s "$BASHER_PACKAGES_PATH/$package/$bin" "$BASHER_ROOT/cellar/bin/${bin##*/}"
done
